<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="John Doe">







<title>Webpack | Hexo</title>



    <link rel="icon" href="/favicon.ico">



<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=Roboto+Mono&display=swap');
</style>



    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    




    <!-- scripts list from _config.yml -->
    
    <script src="/js/menu.js"></script>
    










  <meta name="generator" content="Hexo 7.3.0"></head>
  <body>
    <div class="mask-border">
    </div>

    <div class="wrapper">

      <div class="header">
  <div class="flex-container">
    <div class="header-inner">
      <div class="site-brand-container">
        <a href="/">
          
            Frame.
          
        </a>
      </div>
      <div id="menu-btn" class="menu-btn" onclick="toggleMenu()">
        Menu
      </div>
      <nav class="site-nav">
        <ul class="menu-list">
          
            
              <li class="menu-item">
                <a href="/">Home</a>
              </li> 
                   
          
            
              <li class="menu-item">
                <a href="/archives/">Archive</a>
              </li> 
                   
          
            
              <li class="menu-item">
                <a href="/categories/gallery/">Gallery</a>
              </li> 
                   
          
          
        </ul>
      </nav>
    </div>
  </div>
</div>


      <div class="main">
        <div class="flex-container">
          <article id="post">

  
    <div class="post-head">
    <div class="post-info">
        <div class="tag-list">
            
        </div>
        <div class="post-title">
            
            
                Webpack
            
            
        </div>
        <span class="post-date">
            Sep 21, 2024
        </span>
    </div>
    <div class="post-img">
        
            <div class="h-line-primary"></div>
              
    </div>
</div>
    <div class="post-content">
    <h2 id="一-特性清单"><a href="#一-特性清单" class="headerlink" title="一.特性清单"></a>一.特性清单</h2><ol>
<li><p>自动采用严格模式，忽略‘use strict’\</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;module&quot;&gt;</span><br><span class="line">console.log(this)// undefinded</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
<li><p>每个esm模块都是单独的私有作用域</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;module&quot;&gt;</span><br><span class="line">let foo=1;</span><br><span class="line">console.log(foo)// 1</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;module&quot;&gt;</span><br><span class="line">console.log(foo)// undefinded</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

</li>
<li><p>ESM是通过cors去请求可外部js模块的</p>
</li>
<li><p>ESM的scirpt标签会延迟执行脚本（类似于加上defer）</p>
</li>
<li></li>
</ol>
<h2 id="二-export和import"><a href="#二-export和import" class="headerlink" title="二.export和import"></a>二.export和import</h2><h3 id="export"><a href="#export" class="headerlink" title="export"></a>export</h3><p>方法一：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export var name=&#x27;toto&#x27;</span><br><span class="line"></span><br><span class="line">export function say()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export class Person&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>方法二：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var name;</span><br><span class="line">function say()&#123;&#125;;</span><br><span class="line">class Person&#123;&#125;;</span><br><span class="line"></span><br><span class="line">export &#123;name,say,Person&#125;;</span><br></pre></td></tr></table></figure>

<p>导出重命名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export &#123;</span><br><span class="line">	name as default, //default默认导出，导入时必须重命名</span><br><span class="line">	say as mySay,</span><br><span class="line">	Person as myPerson</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//引入时</span><br><span class="line">import &#123;default as myName,mySay,myPerson&#125; from &#x27;&lt;路径&gt;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h3><ul>
<li>导入和导出<strong>不能理解为引出对象和解构。</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var name=&#x27;toto&#x27;</span><br><span class="line">var age=18</span><br><span class="line">var obj=&#123;name,age&#125;</span><br><span class="line"></span><br><span class="line">export &#123;name,age&#125;;</span><br><span class="line">// &#123;&#125;只是一个默认语法，不能认为时字面量对象，即这里导出的时name和age,而不是obj</span><br><span class="line">export default &#123;name,age&#125;</span><br><span class="line">// 加上default之后，可以认为后面导出的是一个对象，name和age是里面的属性</span><br></pre></td></tr></table></figure>

<ul>
<li>导入和导出的变量<strong>引用同一个地址</strong>，并不是拷贝。</li>
<li>导出后并不能修改导出前的变量，只读。（不然就会乱套）</li>
</ul>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#123;name&#125; from &#x27;./util/index.js&#x27; //相对</span><br><span class="line">import &#123;name&#125; from &#x27;/04-util/index.js&#x27; //绝对</span><br><span class="line">import &#123;name&#125; from &#x27;http:/local...&#x27; //url</span><br><span class="line"></span><br><span class="line">import &#123;&#125; from &#x27;./module.js&#x27;//只执行不提取</span><br><span class="line"></span><br><span class="line">import * as mod from &#x27;./&#x27;// 全部引用</span><br><span class="line"></span><br><span class="line">import &#123;name&#125; from &#x27;./util/index.js&#x27; //相对</span><br></pre></td></tr></table></figure>

<p>动态导入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var modulePath=&#x27;./module.js&#x27;</span><br><span class="line">import &#123;name&#125; from modulePath</span><br><span class="line">console.log(name)</span><br><span class="line"></span><br><span class="line">if(true)&#123;</span><br><span class="line">import &#123;name&#125; from &#x27;./module.js&#x27;</span><br><span class="line">&#125;</span><br><span class="line">//import &#123;name&#125; from &#x27;./module.js&#x27; 只能在最顶部调用</span><br><span class="line">//如遇上述两种情况，需要动态导入</span><br><span class="line">//把他写为函数，这样在哪里都可以调用</span><br><span class="line">import(&#x27;./module.js&#x27;).then(function(module)&#123;console.log(module)&#125;)</span><br><span class="line">//f</span><br></pre></td></tr></table></figure>

<p>默认导入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123;name,default as title&#125; from &#x27;./&#x27;</span><br><span class="line">// 简写</span><br><span class="line">import title,&#123;name&#125; from &#x27;./&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="三-渡一webpcack笔记"><a href="#三-渡一webpcack笔记" class="headerlink" title="三.渡一webpcack笔记"></a>三.渡一webpcack笔记</h2><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>Webpack的作用是将源代码编译（构建、打包）成最终代码。</p>
<h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><ol>
<li><p>初始化</p>
</li>
<li><p>编译</p>
</li>
<li><p>输出</p>
</li>
</ol>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>此阶段，webpack会将cli参数、配置文件、默认配置进行融合，形成一个最终的配置对象。</p>
<p>对配置的处理过程是依托一个第三方库yargs完成的</p>
<p>可以理解为初始化阶段就是产生一个最终的配置。</p>
<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><p><img src="/../images/image-20240921224624123.png" alt="image-20240921224624123"></p>
<h4 id="1-创建chunk"><a href="#1-创建chunk" class="headerlink" title="1.创建chunk"></a>1.创建chunk</h4><p>chunk是wenbpack里的内部构建过程中的一个概念，译为<strong>块</strong>，他表示通<strong>过入口找到的所有依赖的统称</strong>。</p>
<p>根据入口模块（默认为.&#x2F;src&#x2F;index.js）创建一个chunk</p>
<p>(入口文件可能有多个，所有chunk有可能有多个)默认情况下偶一个</p>
<p>每个chunk都有至少两个属性：</p>
<ol>
<li>name：默认为main</li>
<li>id:唯一编号，开发环境和name相同，生产环境是一个数字，从0开始。</li>
</ol>
<h4 id="2-构建所有依赖模块"><a href="#2-构建所有依赖模块" class="headerlink" title="2.构建所有依赖模块"></a>2.构建所有依赖模块</h4><p>首先检查该模块文件是否加载过，如果加载过，结束；未加载过，继续下一步。（先进入”.&#x2F;src&#x2F;index.js”）</p>
<p>接着读取文件内容，构建抽象语法树AST。（分析里面的依赖关系）</p>
<p>记录依赖，存放到dependences中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&quot;./src/a.js&quot;,&quot;./src/b.js&quot;]</span><br></pre></td></tr></table></figure>

<p>替换依赖后的函数：</p>
<p><img src="/../images/image-20240921224629993.png" alt="image-20240921224629993"></p>
<p>把转换后的模块代码并记录到chunk中的模块记录：</p>
<p><img src="/../images/image-20240921224638565.png" alt="image-20240921224638565"></p>
<p>根据dependencies的内容递归加载模块。(相当于先到index,index中有引入a,再到a，a中有引入b,再到b,b中没有引入了，那么返回最开始，加载dependences里面的第二项，即”.&#x2F;src&#x2F;b.js”，再看b，由于检查到已经加载过b,那么b就不会继续加载了，结束)</p>
<h4 id="3-产生chunk"><a href="#3-产生chunk" class="headerlink" title="3.产生chunk"></a>3.产生chunk</h4><p>根据第二步的模块列表，产生文件列表。</p>
<p><img src="/../images/image-20240921224644101.png" alt="image-20240921224644101"></p>
<p>所有文件内容联合起来，生成一个固定长度的字符串，且可以保证原始内容不变，产生的hash字符串就不变。</p>
<h4 id="4-合并chunk-assets"><a href="#4-合并chunk-assets" class="headerlink" title="4.合并chunk assets"></a>4.合并chunk assets</h4><p>将读个chunk的assertsh合并到一起，并产生一个总的hash</p>
<p><img src="/../images/image-20240921224650388.png" alt="image-20240921224650388"></p>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>webpack将利用node中的fs模块（文件处理模块），根据编译产生的总的assets，产生相应的文件</p>
<p><img src="/../images/image-20240921224655422.png" alt="image-20240921224655422"></p>
<h3 id="总过程"><a href="#总过程" class="headerlink" title="总过程"></a>总过程</h3><p><img src="/../images/image-20240921224700734.png" alt="image-20240921224700734"></p>

</div> 

<script>
    window.onload = detectors();
</script>
    <div class="post-footer">
    <div class="h-line-primary"></div>
    <nav class="post-nav">
        <div class="prev-item">
           
                <div class="icon arrow-left"></div>
                <div class="post-link">
                    <a href="/2024/09/21/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/">Prev</a>
                </div>
            
        </div>
        <div class="next-item">
            
                <div class="icon arrow-right"></div>
                <div class="post-link">
                  <a href="/2024/09/21/Vue3/">Next</a>  
                </div>  
            
        </div>
    </nav>
</div>

    
      <div class="post-comment">

     

     
    
    

</div>
     
  
</article>
        </div>
      </div>
      
      <div class="footer">
    <div class="flex-container">
        <div class="footer-text">
            
            
            
                Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/zoeingwingkei/frame/">Frame</a>
                
        </div>
    </div>
</div>

    </div>

    
    

  </body>
</html>
